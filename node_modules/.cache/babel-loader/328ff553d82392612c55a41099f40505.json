{"ast":null,"code":"import _asyncToGenerator from\"/Users/admin/Desktop/react-pr/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _objectSpread from\"/Users/admin/Desktop/react-pr/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _regeneratorRuntime from\"/Users/admin/Desktop/react-pr/node_modules/@babel/runtime/regenerator/index.js\";import{stopSubmit}from\"redux-form\";import{authAPI}from\"../api/api\";var SET_USER_DATA='SET_USER_DATA';var initialState={userId:null,email:null,login:null,isAuth:false};var authReducer=function authReducer(){var state=arguments.length>0&&arguments[0]!==undefined?arguments[0]:initialState;var action=arguments.length>1?arguments[1]:undefined;switch(action.type){case SET_USER_DATA:return _objectSpread(_objectSpread({},state),action.payload);default:return state;}};export var setAuthUserData=function setAuthUserData(userId,email,login,isAuth){return{type:SET_USER_DATA,payload:{userId:userId,email:email,login:login,isAuth:isAuth}};};export var getAuthUserData=function getAuthUserData(){return/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(dispach){var response,_response$data$data,id,email,_login;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return authAPI.my();case 2:response=_context.sent;if(response.data.resultCode===0){_response$data$data=response.data.data,id=_response$data$data.id,email=_response$data$data.email,_login=_response$data$data.login;dispach(setAuthUserData(id,email,_login,true));}case 4:case\"end\":return _context.stop();}}},_callee);}));return function(_x){return _ref.apply(this,arguments);};}();};export var login=function login(email,password,rememberMe){return/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(dispach){var response,message;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return authAPI.login(email,password,rememberMe);case 2:response=_context2.sent;if(response.data.resultCode===0){dispach(getAuthUserData());}else{message=response.data.messages.lenght>0?response.data.messages[0]:\"Some error\";dispach(stopSubmit(\"login\",{_error:message}));}case 4:case\"end\":return _context2.stop();}}},_callee2);}));return function(_x2){return _ref2.apply(this,arguments);};}();};export var logout=function logout(){return function(dispach){authAPI.logout().then(function(response){if(response.data.resultCode===0){dispach(setAuthUserData(null,null,null,false));}});};};export default authReducer;","map":{"version":3,"sources":["/Users/admin/Desktop/react-pr/src/redux/auth-reducer.js"],"names":["stopSubmit","authAPI","SET_USER_DATA","initialState","userId","email","login","isAuth","authReducer","state","action","type","payload","setAuthUserData","getAuthUserData","dispach","my","response","data","resultCode","id","password","rememberMe","message","messages","lenght","_error","logout","then"],"mappings":"2VAAA,OAASA,UAAT,KAA2B,YAA3B,CACA,OAASC,OAAT,KAAwB,YAAxB,CAEA,GAAMC,CAAAA,aAAa,CAAG,eAAtB,CAEA,GAAIC,CAAAA,YAAY,CAAG,CACfC,MAAM,CAAE,IADO,CAEfC,KAAK,CAAE,IAFQ,CAGfC,KAAK,CAAE,IAHQ,CAIfC,MAAM,CAAE,KAJO,CAAnB,CAOA,GAAMC,CAAAA,WAAW,CAAG,QAAdA,CAAAA,WAAc,EAAkC,IAAjCC,CAAAA,KAAiC,2DAAzBN,YAAyB,IAAXO,CAAAA,MAAW,2CAElD,OAAQA,MAAM,CAACC,IAAf,EACI,IAAKT,CAAAA,aAAL,CACI,sCACOO,KADP,EAEOC,MAAM,CAACE,OAFd,EAKJ,QACI,MAAOH,CAAAA,KAAP,CARR,CAUH,CAZD,CAcA,MAAO,IAAMI,CAAAA,eAAe,CAAG,QAAlBA,CAAAA,eAAkB,CAACT,MAAD,CAASC,KAAT,CAAgBC,KAAhB,CAAuBC,MAAvB,QAAmC,CAAEI,IAAI,CAAET,aAAR,CAC9DU,OAAO,CAAE,CAACR,MAAM,CAANA,MAAD,CAASC,KAAK,CAALA,KAAT,CAAgBC,KAAK,CAALA,KAAhB,CAAuBC,MAAM,CAANA,MAAvB,CADqD,CAAnC,EAAxB,CAGP,MAAO,IAAMO,CAAAA,eAAe,CAAG,QAAlBA,CAAAA,eAAkB,kGAAK,iBAAOC,OAAP,yLACbd,CAAAA,OAAO,CAACe,EAAR,EADa,QAC9BC,QAD8B,eAG1B,GAAIA,QAAQ,CAACC,IAAT,CAAcC,UAAd,GAA6B,CAAjC,CAAoC,qBACTF,QAAQ,CAACC,IAAT,CAAcA,IADL,CAC7BE,EAD6B,qBAC7BA,EAD6B,CACzBf,KADyB,qBACzBA,KADyB,CAClBC,MADkB,qBAClBA,KADkB,CAElCS,OAAO,CAACF,eAAe,CAACO,EAAD,CAAKf,KAAL,CAAYC,MAAZ,CAAmB,IAAnB,CAAhB,CAAP,CACD,CANyB,sDAAL,gEAAxB,CAWP,MAAO,IAAMA,CAAAA,KAAK,CAAG,QAARA,CAAAA,KAAQ,CAACD,KAAD,CAAQgB,QAAR,CAAkBC,UAAlB,kGAAgC,kBAAOP,OAAP,kKACzBd,CAAAA,OAAO,CAACK,KAAR,CAAcD,KAAd,CAAqBgB,QAArB,CAA+BC,UAA/B,CADyB,QAC1CL,QAD0C,gBAG3C,GAAIA,QAAQ,CAACC,IAAT,CAAcC,UAAd,GAA6B,CAAjC,CAAoC,CAClCJ,OAAO,CAACD,eAAe,EAAhB,CAAP,CACD,CAFD,IAGA,CACMS,OADN,CACgBN,QAAQ,CAACC,IAAT,CAAcM,QAAd,CAAuBC,MAAvB,CAAgC,CAAhC,CAAoCR,QAAQ,CAACC,IAAT,CAAcM,QAAd,CAAuB,CAAvB,CAApC,CAAgE,YADhF,CAEET,OAAO,CAACf,UAAU,CAAC,OAAD,CAAU,CAAC0B,MAAM,CAAEH,OAAT,CAAV,CAAX,CAAP,CACD,CAT0C,wDAAhC,kEAAd,CAaH,MAAO,IAAMI,CAAAA,MAAM,CAAG,QAATA,CAAAA,MAAS,SAAK,UAACZ,OAAD,CAAW,CAClCd,OAAO,CAAC0B,MAAR,GACCC,IADD,CACM,SAAAX,QAAQ,CAAI,CAChB,GAAIA,QAAQ,CAACC,IAAT,CAAcC,UAAd,GAA6B,CAAjC,CAAoC,CAClCJ,OAAO,CAACF,eAAe,CAAC,IAAD,CAAO,IAAP,CAAa,IAAb,CAAmB,KAAnB,CAAhB,CAAP,CACD,CACF,CALD,EAMH,CAPqB,EAAf,CAUX,cAAeL,CAAAA,WAAf","sourcesContent":["import { stopSubmit } from \"redux-form\";\nimport { authAPI } from \"../api/api\";\n\nconst SET_USER_DATA = 'SET_USER_DATA';\n\nlet initialState = {\n    userId: null,\n    email: null,\n    login: null,\n    isAuth: false\n}\n\nconst authReducer = (state = initialState, action) => {\n\n    switch (action.type) {\n        case SET_USER_DATA:\n            return {\n                ...state, \n                ...action.payload\n                \n            }\n        default:\n            return state;\n    }\n}\n\nexport const setAuthUserData = (userId, email, login, isAuth) => ({ type: SET_USER_DATA, \n    payload: {userId, email, login, isAuth} })\n\nexport const getAuthUserData = ()=> async (dispach)=>{\n  let response = await authAPI.my()\n  \n          if (response.data.resultCode === 0) {\n            let {id, email, login} = response.data.data;\n            dispach(setAuthUserData(id, email, login, true));\n          }\n      \n    }\n\n\nexport const login = (email, password, rememberMe)=> async (dispach)=>{\n       let response = await authAPI.login(email, password, rememberMe)\n       \n          if (response.data.resultCode === 0) {\n            dispach(getAuthUserData());\n          } else\n          {\n            let message = response.data.messages.lenght > 0 ? response.data.messages[0] : \"Some error\"\n            dispach(stopSubmit(\"login\", {_error: message}));\n          }\n   \n    }\n\n    export const logout = ()=> (dispach)=>{\n        authAPI.logout()\n        .then(response => {\n          if (response.data.resultCode === 0) {\n            dispach(setAuthUserData(null, null, null, false));\n          }\n        });\n    }\n\n\nexport default authReducer;"]},"metadata":{},"sourceType":"module"}